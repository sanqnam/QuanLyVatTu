<div class="row" style="border-bottom: 2px solid blue; margin-bottom: 20px;">
    <div class="pagetitle col-lg-3 col-md-3">
      <h1>Phiếu Duyệt</h1>
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="index.html">Home</a></li>
          <li class="breadcrumb-item">Phiếu</li>
          <li class="breadcrumb-item">Phiếu duyệt</li>
          <li class="breadcrumb-item active">Mua vật tư</li>
        </ol>
      </nav>
  </div>
  <div class="col-lg-9 col-md-9">
    <form [formGroup]="filterForm">
      <div class="row">
        <div class="col-2" style="float: left;">
          <select class="form-select" name="size" formControlName="size" (change)="filterSelect()"
            [(ngModel)]="tableSize">
            <ng-container *ngFor="let size of tableSizes">
              <option [selected]="size == tableSize" [value]="size">{{size}}</option>
            </ng-container>
          </select>
        </div>
        <div class="col-5" style="float: left; padding-right: 15px;">
          <select class="form-select" name="sortOrder" formControlName="sortOrder" (change)="filterSelect()"
            [(ngModel)]="sortOrder">
            <option [value]="1"> Mới nhất</option>
            <ng-container>
              <option [value]="2">
               Cũ nhất
              </option>
            </ng-container>
          </select>
        </div>
      </div>
    </form>
  </div>
  </div>
  <section class="section profile">
    <div class="row">
      
      <table class="table table-hover">
        <thead>
          <tr style="line-height: 36px;">
            <th scope="col">#</th>
            <th scope="col">Người yêu cầu</th>
            <th scope="col">Thời gian tạo phiếu</th>
            <th scope="col">Tổng tiền</th>
            <th scope="col">Tình trạng phiếu</th>
            <th scope="col">Tùy chọn</th>
          </tr>
        </thead>
        <tbody>
          <tr style="line-height: 32px;" *ngFor="let dsphieu of DsPhieu
                                  | paginate:{
                                    itemsPerPage: tableSize,
                                    currentPage: page,
                                    totalItems: counts
                                    }; let i = index ">
            <th scope="row">{{i+1}}</th>
            <td>{{dsphieu.tenNguoiMua}}</td>
            <td>{{dsphieu.timeTaoPhieu | date: 'dd/MM/yyyy HH:mm'}}</td>
            <td>{{formatCurrency(dsphieu.tongTien) }}</td>
            <td>{{dsphieu.tinhTrangPhieu}}</td>
            
            <td>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#ExtralargeModal" (click)="combinedLoad(dsphieu.idPhieuTrinhMua)">
                  <i class="bx bx-edit"></i>
                </button></td>
          </tr>
        </tbody>
      </table>
      <div class="row" *ngIf="DsPhieu!=null">
        <pagination-controls class="pagination justify-content-center" style="padding-top: 14px;" previousLabel="Prev"
          nextLabel="Next" (pageChange)="onTableDataChange($event)">
        </pagination-controls>
      </div>
      
      <div class="modal fade " id="ExtralargeModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
          <div class="modal-content">
            <div class="modal-header row">
              <div class="col-2">
                <h5 class="modal-title">Chi Tiết</h5>
              </div>
              <div class="col-3 text-body" *ngIf="showPhieuMua">
                Tổng tiền: {{formatCurrency(phieuMua.tongTien)}}
              </div>
              <div class="col-2" *ngIf="showPhieuMua &&showDK">
                Số lần sửa: {{phieuMua.soLanSuaPhieu}}
              </div>
              <div class="col-4" *ngIf="showPhieuMua && showDK">
                Lý Do: {{phieuMua.lyDoSuaPhieu}}
              </div>
              <div class="col-1">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                (click)="ngOnInit()"></button>
              </div>              
            </div>
            <div class="modal-body">
              <!-- <app-chitietphieu [chiTiet]="chiTietPhieu" [phieu]="phieu" [display]="display"> </app-chitietphieu> -->
              <!-- <app-chi-tiet-phieu-sua [chiTiet]="chiTietPhieu" [phieu]="phieu"></app-chi-tiet-phieu-sua> -->
              <app-duyet-phieu-mua [chiTiet]="dsChiTiet" [phieu]="phieuMua" ></app-duyet-phieu-mua>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
